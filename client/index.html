
<div id="signDiv">
  Username: <input id="signDiv-username" type="text"></input><br>
  Password: <input id="signDiv-password" type="password"></input><br>
  <button id="signDiv-signIn">Sign In</button>
  <button id="signDiv-signUp">Sign Up</button>
</div>

<div id="gameDiv" style="display:none;">
  <canvas id="speedGameCanvas" width="1280" height="720"
    style="border: 1px solid #000000;"></canvas>

  <div id="chat-text" style="width: 500px; height: 100px; overflow-y:scroll">

  </div>

  <form id="chat-form">
    <input id="chat-input" type="text" style="width: 500px"></input><br>
  </form>
  <div>
    <button id="startGame">Start Game!</button>
  </div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script src="/client/js/GameCanvasGenerator.js"></script>

<script>
var socket = io();
var loggedInPlayerName;
var loggedInPlayerSkillLvl;
var opponentName;
var opponentSkillLvl;

//Card Loader
cardsPileOne = {};
cardsPileTwo = {};
playerOneCards = {};
playerTwoCards = {};

playerOneDeckArray = [];
playerTwoDeckArray = [];
cardsPileOneArray = [];
cardsPileTwoArray = [];
playerOneCardsArray = [];
playerTwoCardsArray = [];
cardsPileOneArray = [];
cardsPileTwoArray = [];
var playerNum;

keyCombos = {
  one : false,
  two : false,
  q : false,
  w : false,
  e : false,
  r : false
}


//Sign In
var signDiv = document.getElementById('signDiv');
var gameDiv = document.getElementById('gameDiv');
var signDivUsername = document.getElementById('signDiv-username');
var signDivPassword = document.getElementById('signDiv-password');
var signDivSignIn = document.getElementById('signDiv-signIn');
var signDivSignUp = document.getElementById('signDiv-signUp');

signDivSignIn.onclick = function(){
  socket.emit('signIn',{username: signDivUsername.value, password: signDivPassword.value});
}

signDivSignUp.onclick = function(){
  socket.emit('signUp',{username: signDivUsername.value, password: signDivPassword.value});
}

socket.on('signInResponse', function(data){
  if (data.success) {
    loggedInPlayerName = signDivUsername.value;
    playerNum = data.numberOfPlayers;
    signDiv.style.display = 'none';
    gameDiv.style.display = 'inline-block';
  } else {
    alert("Sign In Unsuccessful");
  }
});

socket.on('signUpResponse', function(data){
  if (data.success) {
    alert("Sign Up Sucessful")
  } else {
    alert("Sign Up Unsuccessful");
  }
});

socket.on('getSkill', function(data){
  loggedInPlayerSkillLvl = data.skillLvl;
});

//Game
//Client
var chatText = document.getElementById('chat-text');
var chatInput = document.getElementById('chat-input');
var chatForm = document.getElementById('chat-form');
speedGameCanvas = document.getElementById('speedGameCanvas').getContext("2d");
startGameButton = document.getElementById('startGame');

startGameButton.addEventListener('click', function(){
  socket.emit('gameStart',{startGame: true});
});

speedGameCanvas.font = '20px Arial';
speedGameCanvas.fillStyle = "white";

socket.on('newPosition',function(data){
  //speedGameCanvas.clearRect(0,0,1280,720);
   //for (var i = 0; i < data.player.length; i++)
   //{
    // speedGameCanvas.fillText(data.player[i].number,data.player[i].x, data.player[i].y);
   //}
});

socket.on('addToChat', function(data){
    chatText.innerHTML += '<div>' + data + '</div>';
    chatText.scrollTop = chatText.scrollHeight;
});

chatForm.onsubmit = function(e){
    e.preventDefault();
    if (chatInput.value != "") {
      socket.emit('sendMsgToServer', chatInput.value, loggedInPlayerName);
      chatInput.value = '';
    }
}

function transferServerCardArrays(data){
  playerOneDeckArray = Array.from(data.pOneDeck);
  playerTwoDeckArray = Array.from(data.pTwoDeck);
  playerOneCardsArray = Array.from(data.pOneHand);
  playerTwoCardsArray = Array.from(data.pTwoHand);
  cardsPileOneArray = Array.from(data.pileOne);
  cardsPileTwoArray = Array.from(data.pileTwo);
}

socket.on('deckCreated',function(data){
  //speedGameCanvas.clearRect(0,0,1280,720);

  transferServerCardArrays(data);
  for (var i = 0; i < playerOneCardsArray.length; i++) {
    console.log("PONE Card " + i + " Is: " + playerOneCardsArray[i].cardType + " of " + playerOneCardsArray[i].suitName);
    console.log("PTWO Card " + i + " Is: " + playerTwoCardsArray[i].cardType + " of " + playerTwoCardsArray[i].suitName);
  }

  if(playerNum == 0)
    firstPlayerPlayState(data);
  if(playerNum == 1)
    secondPlayerPlayState(data);
  //generateGameView(data);
});

document.onkeydown = function(event){
  if (event.keyCode === 49){
    keyCombos.one = true;
    keyCombos.two = false;
  } //1
  else if (event.keyCode === 50){
    keyCombos.one = false;
    keyCombos.two = true;
  } //2
  else if (event.keyCode === 81){
    keyCombos.q = true;
    keyCombos.w = false;
    keyCombos.e = false;
    keyCombos.r = false;
  } //Q
  else if (event.keyCode === 87){
    keyCombos.q = false;
    keyCombos.w = true;
    keyCombos.e = false;
    keyCombos.r = false;
  } //W
  else if (event.keyCode === 69){
    keyCombos.q = false;
    keyCombos.w = false;
    keyCombos.e = true;
    keyCombos.r = false;
  } //E
  else if (event.keyCode === 82){
    keyCombos.q = false;
    keyCombos.w = false;
    keyCombos.e = false;
    keyCombos.r = true;
  } //R
  else if (event.keyCode === 13) {
    if (keyCombos.one === true && keyCombos.q === true)
      socket.emit('keyPress',{inputId: 'firstHandCardToPileOne', state: true});
    else if (keyCombos.one === true && keyCombos.w === true)
      socket.emit('keyPress',{inputId: 'secondHandCardToPileOne', state: true});
    else if (keyCombos.one === true && keyCombos.e === true)
      socket.emit('keyPress',{inputId: 'thirdHandCardToPileOne', state: true});
    else if (keyCombos.one === true && keyCombos.r === true)
      socket.emit('keyPress',{inputId: 'fourthHandCardToPileOne', state: true});

    else if (keyCombos.two === true && keyCombos.q === true)
      socket.emit('keyPress',{inputId: 'firstHandCardToPileTwo', state: true});
    else if (keyCombos.two === true && keyCombos.w === true)
      socket.emit('keyPress',{inputId: 'secondHandCardToPileTwo', state: true});
    else if (keyCombos.two === true && keyCombos.e === true)
      socket.emit('keyPress',{inputId: 'thirdHandCardToPileTwo', state: true});
    else if (keyCombos.two === true && keyCombos.r === true)
      socket.emit('keyPress',{inputId: 'fourthHandCardToPileTwo', state: true});
  } //ENTER
}

document.onkeyup = function(event){
  if (event.keyCode === 13) //ENTER
    socket.emit('keyPress',{inputId: 'reset', state: false});
}

loadGameBackground();

</script>
